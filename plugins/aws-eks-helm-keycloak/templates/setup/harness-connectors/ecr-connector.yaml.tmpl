# Harness ECR Connector Template
# Generated by /eks:setup
#
# This connector enables Harness to pull/push images from ECR

connector:
  name: ${CONNECTOR_NAME:-ecr_connector}
  identifier: ${CONNECTOR_ID:-ecr_connector}
  description: "ECR registry connector for container images"
  orgIdentifier: ${HARNESS_ORG_ID}
  projectIdentifier: ${HARNESS_PROJECT_ID}
  type: Ecr
  spec:
    # AWS Region
    region: ${AWS_REGION}

    # ECR Registry URL
    ecrUrl: ${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_REGION}.amazonaws.com

    # Authentication
    credential:
      # Option 1: IRSA (Recommended)
      type: Irsa
      spec:
        delegateSelector: ${DELEGATE_SELECTOR:-eks-delegate}

      # Option 2: Use AWS Connector
      # type: AWSConnector
      # spec:
      #   awsConnectorRef: aws_connector

      # Option 3: Manual credentials
      # type: ManualConfig
      # spec:
      #   accessKeyId: <+secrets.getValue("aws_access_key")>
      #   secretAccessKey: <+secrets.getValue("aws_secret_key")>

    # Execute on delegate
    executeOnDelegate: true

    # Delegate selectors
    delegateSelectors:
      - ${DELEGATE_SELECTOR:-eks-delegate}
